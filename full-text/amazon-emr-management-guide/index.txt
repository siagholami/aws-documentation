Amazon EMR Management Guide

*Copyright Â© 2020 Amazon Web Services, Inc. and/or its affiliates. All rights reserved.***

Amazon's trademarks and trade dress may not be used in 
     connection with any product or service that is not Amazon's, 
     in any manner that is likely to cause confusion among customers, 
     or in any manner that disparages or discredits Amazon. All other 
     trademarks not owned by Amazon are the property of their respective
     owners, who may or may not be affiliated with, connected to, or 
     sponsored by Amazon.

Contents

What Is Amazon EMR?
Overview of Amazon EMR
Benefits of Using Amazon EMR
Overview of Amazon EMR Architecture
Getting Started: Analyzing Big Data with Amazon EMR
Step 1: Set Up Prerequisites for Your Sample Cluster
Step 2: Launch Your Sample Amazon EMR Cluster
Step 3: Allow SSH Connections to the Cluster From Your Client
Step 4: Process Data By Running The Hive Script as a Step
Step 5: Terminate the Cluster and Delete the Bucket
Using Amazon EMR Notebooks
Considerations When Using EMR Notebooks
Creating a Notebook
Creating Amazon EMR Clusters for Notebooks
Working with Notebooks
Monitoring Spark User and Job Activity
EMR Notebooks Security and Access Control
Using Notebook-Scoped Libraries
Associate Git Repositories with Amazon EMR Notebooks
Add a Git Repository to Amazon EMR
Update or Delete a Git Repository
Link or Unlink a Git Repository
Create a New Notebook with an Associated Git Repository
Use Git Repositories in a Notebook


Plan and Configure Clusters
Configure Cluster Location and Data Storage
Choose an AWS Region
Work with Storage and File Systems
Prepare Input Data
Types of Input Amazon EMR Can Accept
How to Get Data Into Amazon EMR
Upload Data to Amazon S3
Import files with Distributed Cache
How to Process Compressed Files
Import DynamoDB Data into Hive
Connect to Data with AWS DirectConnect
Upload Large Amounts of Data with AWS Import/Export




Configure an Output Location
What formats can Amazon EMR return?
How to write data to an Amazon S3 bucket you don't own
Compress the Output of your Cluster




Plan and Configure Master Nodes
Supported Applications and Features
Launching an EMR Cluster with Multiple Master Nodes
Considerations and Best Practices


EMR Clusters on AWS Outposts
Use EMR File System (EMRFS)
Consistent View
Enable Consistent View
Understanding How EMRFS Consistent View Tracks Objects in Amazon S3
Retry Logic
EMRFS Consistent View Metadata
Configure Consistency Notifications for CloudWatch and Amazon SQS
Configure Consistent View
EMRFS CLI Reference


Authorizing Access to EMRFS Data in Amazon S3
Specifying Amazon S3 Encryption Using EMRFS Properties
Amazon S3 Client-Side Encryption




Control Cluster Termination
Configuring a Cluster to Auto-Terminate or Continue
Using Termination Protection


Working with Amazon Linux AMIs in Amazon EMR
Using the Default Amazon Linux AMI for Amazon EMR
Using a Custom AMI
Specifying the Amazon EBS Root Device Volume Size


Configure Cluster Software
Create Bootstrap Actions to Install Additional Software


Configure Cluster Hardware and Networking
Understanding Master, Core, and Task Nodes
Configure EC2 Instances
Supported Instance Types
Instance Purchasing Options
Instance Storage


Configure Networking
Amazon VPC Options
Set up a VPC to Host Clusters
Launch Clusters into a VPC
Restrict Permissions to a VPC Using IAM
Minimum Amazon S3 Policy for Private Subnet


Create a Cluster with Instance Fleets or Uniform Instance Groups
Configure Instance Fleets
Configure Uniform Instance Groups


Cluster Configuration Guidelines and Best Practices


Configure Cluster Logging and Debugging
Tag Clusters
Tag Restrictions
Tag Resources for Billing
Add Tags to a New Cluster
Adding Tags to an Existing Cluster
View Tags on a Cluster
Remove Tags from a Cluster


Drivers and Third-Party Application Integration
Use Business Intelligence Tools with Amazon EMR


Security in Amazon EMR
Use Security Configurations to Set Up Cluster Security
Create a Security Configuration
Specify a Security Configuration for a Cluster


Data Protection in Amazon EMR
Encrypt Data at Rest and in Transit
Encryption Options
Create Keys and Certificates for Data Encryption




AWS Identity and Access Management for Amazon EMR
How Amazon EMR Works with IAM
Configure IAM Service Roles for Amazon EMR Permissions to AWS Services and Resources
IAM Service Roles Used By Amazon EMR
Service Role for Amazon EMR (EMR Role)
Service Role for Cluster EC2 Instances (EC2 Instance Profile)
Service Role for Automatic Scaling in EMR (Auto Scaling Role)
Service Role for EMR Notebooks
Using the Service-Linked Role for Amazon EMR


Customize IAM Roles
Configure IAM Roles for EMRFS Requests to Amazon S3
Use Resource-Based Policies for Amazon EMR Access to AWS Glue Data Catalog
Use IAM Roles with Applications That Call AWS Services Directly
Allow Users and Groups to Create and Modify Roles


Amazon EMR Identity-Based Policy Examples
Policy Best Practices for Amazon EMR
Allow Users to View Their Own Permissions
Amazon EMR Managed Policies
IAM Policies for Tag-Based Access to Clusters and EMR Notebooks




Authenticate to Amazon EMR Cluster Nodes
Use an Amazon EC2 Key Pair for SSH Credentials
Use Kerberos Authentication
Supported Applications
Kerberos Architecture Options
Configuring Kerberos on Amazon EMR
Security Configuration and Cluster Settings for Kerberos on Amazon EMR
Configuration Examples
Configuring a Cluster for Kerberos-Authenticated HDFS Users and SSH Connections


Using SSH to Connect to Kerberized Clusters
Tutorial: Configure a Cluster-Dedicated KDC
Tutorial: Configure a Cross-Realm Trust with an Active Directory Domain




Integrating Amazon EMR with AWS Lake Formation (Beta)
Conceptual Overview of Amazon EMR Integration with Lake Formation
Terms and Concepts
How Access to Data Works in Lake Formation
Amazon EMR Components
Architecture of SAML-Enabled Single Sign-On and Fine-Grained Access Control


Supported Applications and Features
Before You Begin
Overview of the IAM Roles for Lake Formation
Configure Trust Relationship Between your IdP and Lake Formation
Supported Third-Party Providers for SAML
Configure EMR Security Features


Launch an Amazon EMR Cluster with Lake Formation
Launch an Amazon EMR cluster with Lake Formation using the console
Launch an Amazon EMR cluster integrated with Lake Formation using the CLI
Update the callback or single sign-on URL in IdP
Using Notebooks with Lake Formation
Customize Proxy Agent Certificate




Control Network Traffic with Security Groups
Working With Amazon EMR-Managed Security Groups
Working With Additional Security Groups
Specifying Amazon EMR-Managed and Additional Security Groups
Specifying EC2 Security Groups for EMR Notebooks
Using Amazon EMR Block Public Access


Compliance Validation for Amazon EMR
Resilience in Amazon EMR
Infrastructure Security in Amazon EMR
Connect to Amazon EMR Using an Interface VPC Endpoint


Manage Clusters
View and Monitor a Cluster
View Cluster Status and Details
Enhanced Step Debugging
View Application History
One-click Access to Persistent Spark History Server
View a Summary of Application History


View Log Files
View Cluster Instances in Amazon EC2
CloudWatch Events and Metrics
Monitor CloudWatch Events
Monitor Metrics with CloudWatch


View Cluster Application Metrics with Ganglia
Logging Amazon EMR API Calls in AWS CloudTrail


Connect to the Cluster
Connect to the Master Node Using SSH
View Web Interfaces Hosted on Amazon EMR Clusters
Option 1: Set Up an SSH Tunnel to the Master Node Using Local Port Forwarding
Option 2, Part 1: Set Up an SSH Tunnel to the Master Node Using Dynamic Port Forwarding
Option 2, Part 2: Configure Proxy Settings to View Websites Hosted on the Master Node
Access the Web Interfaces on the Master Node Using the Console




Terminate a Cluster
Scaling Cluster Resources
Using Automatic Scaling in Amazon EMR
Manually Resizing a Running Cluster
Cluster Scale-Down


Cloning a Cluster Using the Console
Submit Work to a Cluster
Work with Steps Using the AWS CLI and Console
Adding Steps to a Cluster Using the Console
Adding Steps to a Cluster Using the AWS CLI
Considerations for Running Multiple Steps in Parallel
Viewing Steps
Canceling Steps


Submit Hadoop Jobs Interactively
Add More than 256 Steps to a Cluster


Automate Recurring Clusters with AWS Data Pipeline
Troubleshoot a Cluster
What Tools are Available for Troubleshooting?
Viewing and Restarting Amazon EMR and Application Processes (Daemons)
Troubleshoot a Failed Cluster
Step 1: Gather Data About the Issue
Step 2: Check the Environment
Step 3: Look at the Last State Change
Step 4: Examine the Log Files
Step 5: Test the Cluster Step by Step


Troubleshoot a Slow Cluster
Step 1: Gather Data About the Issue
Step 2: Check the Environment
Step 3: Examine the Log Files
Step 4: Check Cluster and Instance Health
Step 5: Check for Arrested Groups
Step 6: Review Configuration Settings
Step 7: Examine Input Data


Common Errors in Amazon EMR
Input and Output Errors
Permissions Errors
Resource Errors
Cluster Terminates With NO_SLAVE_LEFT and Core Nodes FAILED_BY_MASTER
Cannot replicate block, only managed to replicate to zero nodes.
EC2 QUOTA EXCEEDED
Too many fetch-failures
File could only be replicated to 0 nodes instead of 1
Blacklisted Nodes
Throttling Errors
Instance Type Not Supported
EC2 is Out of Capacity


Streaming Cluster Errors
Custom JAR Cluster Errors
Hive Cluster Errors
VPC Errors
AWS GovCloud (US-West) Errors


Troubleshoot a Lake Formation Cluster (Beta)
Write Applications that Launch and Manage Clusters
End-to-End Amazon EMR Java Source Code Sample
Common Concepts for API Calls
Use SDKs to Call Amazon EMR APIs
Using the AWS SDK for Java to Create an Amazon EMR Cluster


AWS Glossary
