Upgrade Instructions
This section provides steps for upgrading from an earlier version of the AWS Service Catalog Connector for ServiceNow.
To upgrade to the latest version of the Connector


Clear the ServiceNow platform cache by typing in the following URL: https://[InsertServiceNowInstanceNameHere]/cache.do
Note
Make sure you are installing the update set in a non-production/sandbox environment. Consult a ServiceNow system administrator if you need approval to clear the ServiceNow platform cache.


Clear the web browser cache.


If you are upgrading from an earlier version, the permissions on ServiceNow Platform tables (User Criteria and Catalog Variable Set) are no longer needed for the Connector for ServiceNow.


Enable permissions on ServiceNow Platform tables (Category and Catalog Item Category).


For AWS products to display under AWS portfolios as sub-categories in the ServiceNow Service Catalog, you need to modify the Application Access form for Category and Catalog Item Category tables.


Enter "Tables" in the Navigator and choose System Definition, Tables.


In the list of tables, search for a table with label "Category" (or name "sc_category"). The list of tables will be displayed. Choose Category to view the form defining the table.


Choose the "Application Access" tab on the form and choose the "Can Create", “Can Update, and "Can delete" checkboxes on the form. Choose the "Update" button.


Repeat the steps used on the Category table above for the "Catalog Item Category" table (type sc_cat_item_category in the “Go to Name Search” field).


From your ServiceNow dashboard, type plugins in the navigation panel in the upper left. 


When the System Plugins page populates, next to the dropdown that says Name, search for user criteria. 


Choose User Criteria Scoped API and then choose Activate. 


Download the Connector for ServiceNow update set from the ServiceNow store. For users installing the update set on a ServiceNow Personal Developer Instance (PDI), download the code from Connector for ServiceNow version 2.3.4 update set. 
The Connector for ServiceNow version 2.3.4 update set may be applied to a “Madrid,” "New York," or "Orlando" platform release of ServiceNow. 


From your ServiceNow dashboard, type update sets in the navigation panel in the upper left. 


Choose Retrieved Update Sets from the results. 


Select Import Update Set from XML and upload the release XML file. 


Select the AWS Service Catalog Connector for ServiceNow update set. 


Choose Preview Update Set, which makes ServiceNow validate the connector update set. 


Choose Update. 


Choose Commit Update Set to apply the update set and create the application. This procedure should complete 100%. 


To update AWS permissions

Go to Creating IAM Policies. Following the instructions there, create a policy called SCConnectorAdmin for ServiceNow administrators to delete AWS Service Catalog products in ServiceNow that do not have self-service actions associated. ServiceNow administrators can also view budgets associated to AWS Service Catalog portfolios and products. Copy the following policy and paste it into Policy Document:

{
                   "Version": "2012-10-17",
                   "Statement": [
                       {
                           "Sid": "VisualEditor0",
                           "Effect": "Allow",
                           "Action": [
                               "servicecatalog:DisassociateProductFromPortfolio",
                               "servicecatalog:DeleteProduct",
                               "servicecatalog:DeleteConstraint",
                               "servicecatalog:DeleteProvisionedProductPlan",
                               "servicecatalog:DeleteProvisioningArtifact",
                               "servicecatalog:ListBudgetsForResource",
                               "budgets:ViewBudget"
                           ],
                           "Resource": "*"
                       }
                   ]
               }
Note
The ServiceCatalogServiceNowAdditionalPermissions AWS policy is no longer needed for the Connector for ServiceNow.

Create a policy called ServiceCatalogSSMActionsBaseline. Follow the instructions at Creating IAM Policies, and paste the following into the JSON editor: 

{
               "Version": "2012-10-17",
               "Statement": [
                   {
                       "Sid": "Stmt1536341175150",
                       "Action": [
                           "servicecatalog:ListServiceActionsForProvisioningArtifact",
                           "servicecatalog:ExecuteprovisionedProductServiceAction",
                           "ssm:DescribeDocument",
                           "ssm:GetAutomationExecution",
                           "ssm:StartAutomationExecution",
                           "ssm:StopAutomationExecution",
                           "cloudformation:ListStackResources",
                           "ec2:DescribeInstanceStatus",
                           "ec2:StartInstances",
                           "ec2:StopInstances"
                       ],
                       "Effect": "Allow",
                       "Resource": "*"
                   }
               ]
           }

Update the AWSCloudFormationFullAccess policy. Choose create policy and then paste the following in the JSON editor:

{
           "Version": "2012-10-17",
           "Statement": [
           {
               "Effect": "Allow",
               "Action": [
               "cloudformation:DescribeStackResource",
               "cloudformation:DescribeStackResources",
               "cloudformation:GetTemplate",
               "cloudformation:List*",
               "cloudformation:DescribeStackEvents",
               "cloudformation:DescribeStacks",
               "cloudformation:CreateStack",
               "cloudformation:DeleteStack",
               "cloudformation:DescribeStackEvents",
               "cloudformation:DescribeStacks",
               "cloudformation:GetTemplateSummary",
               "cloudformation:SetStackPolicy",
               "cloudformation:ValidateTemplate",
               "cloudformation:UpdateStack",
               "cloudformation:CreateChangeSet",
               "cloudformation:DescribeChangeSet",
               "cloudformation:ExecuteChangeSet",
               "cloudformation:DeleteChangeSet",
               "s3:GetObject"
               ],
               "Resource": "*"
           }
       ]
   }
Note
AWSCloudFormationFullAccess now includes additional permissions for ChangeSets.


Attach the ServiceCatalogSSMActionsBaseline and AWSCloudFormationFullAccess  IAM policies to the SCConnectLaunch role, which were created during the Baseline Permissions setup. 


The Connector for ServiceNow includes the ability for ServiceNow administrators to view budgets related to AWS Service Catalog products and portfolios. AWS Service Catalog administrators can create or associate budgets to portfolios and products. For information about creating and associating budgets, see Managing Budgets. 


To add a change request type


When upgrading from a previous version of the AWS Service Catalog scoped app, you must remove the AWS Product Termination change request type before creating a new change request type. 


You also must add a new change request type called AWS Provisioned Product Event for the scoped application to trigger an automated change request in Change Management. For instructions, see Add a new change request type. 
    Open an existing change request.
    Open the context menu for Type and then choose Show Choice List.
    Choose New and fill in the following fields:
Table - Change request
Label - AWS Provisioned Product Event
Value - AWSProvisionedProductEvent
Sequence - pick the next unused value
    Submit the form.

