Setting Up Container Insights on Amazon ECS for Cluster- and Service-Level Metrics
You can enable Container Insights on new and existing Amazon ECS clusters. Container Insights collects metrics at the cluster, task, and service levels. For existing clusters, you use the AWS CLI. For new clusters, use either the Amazon ECS console or the AWS CLI.
If you're using Amazon ECS on an Amazon EC2 instance, and you want to collect network and storage metrics from Container Insights, launch that instance using an AMI that includes Amazon ECS agent version 1.29. For information about updating your agent version, see Updating the Amazon ECS Container Agent
You can use the AWS CLI to set account-level permission to enable Container Insights for any new Amazon ECS clusters created in your account. To do so, enter the following command.
aws ecs put-account-setting --name "containerInsights" --value "enabled"
Setting Up Container Insights on Existing Amazon ECS Clusters
To enable Container Insights on an existing Amazon ECS cluster, enter the following command. You must be running version 1.16.200 or later of the AWS CLI for the following command to work.
aws ecs update-cluster-settings --cluster myCICluster --settings name=containerInsights,value=enabled
Setting Up Container Insights on New Amazon ECS Clusters
There are two ways to enable Container Insights on new Amazon ECS clusters. You can configure Amazon ECS so that all new clusters are enabled for Container Insights by default. Otherwise, you can enable a new cluster when you create it.
Using the AWS Management Console
You can enable Container Insights on all new clusters by default, or on an individual cluster as you create it.
To enable Container Insights on all new clusters by default


Open the Amazon ECS console at https://console.aws.amazon.com/ecs/.


In the navigation pane, choose Account Settings.


Select the check box at the bottom of the page to enable the Container Insights default.


If you haven't used the preceding procedure to enable Container Insights on all new clusters by default, use the following steps to create a cluster with Container Insights enabled.
To create a cluster with Container Insights enabled


Open the Amazon ECS console at https://console.aws.amazon.com/ecs/.


In the navigation pane, choose Clusters.


Choose Create cluster.


On the next page, do the following:


Name your cluster.


If you donâ€™t have a VPC already, select the check box to create one. You can use the default values for the VPC.


Fill out all other needed information, including instance type.


Select Enabled Container Insights.


Choose Create.


You can now create task definitions, run tasks, and launch services in the cluster. For more information, see the following:
 Creating a Task Definition
 Running Tasks
 Creating a Service
Setting Up Container Insights on New Amazon ECS Clusters Using the AWS CLI
To enable Container Insights on all new clusters by default, enter the following command.
aws ecs put-account-setting --name "containerInsights" --value "enabled"
If you didn't use the preceding command to enable Container Insights on all new clusters by default, enter the following command to create a new cluster with Container Insights enabled. You must be running version 1.16.200 or later of the AWS CLI for the following command to work.
aws ecs create-cluster --cluster-name myCICluster --settings "name=containerInsights,value=enabled"
Disabling Container Insights on Amazon ECS Clusters
To disable Container Insights on an existing Amazon ECS cluster, enter the following command.
aws ecs update-cluster-settings --cluster myCICluster --settings name=containerInsights,value=disabled