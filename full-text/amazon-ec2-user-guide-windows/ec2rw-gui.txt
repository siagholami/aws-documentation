Using EC2Rescue for Windows Server GUI
EC2Rescue for Windows Server can perform the following analysis on an offline instance:



Option
Description




Diagnose and Rescue
EC2Rescue for Windows Server can detect and address issues with the following service settings: [See the AWS documentation website for more details] [See the AWS documentation website for more details] [See the AWS documentation website for more details] [See the AWS documentation website for more details] [See the AWS documentation website for more details] [See the AWS documentation website for more details]


Restore
Perform one of the following actions: [See the AWS documentation website for more details]


Capture Logs
Allows you to capture logs on the instance for analysis.



EC2Rescue for Windows Server can collect the following data from active and offline instances:



Item
Description




Event Log
Collects application, system, and EC2Config event logs.


Memory Dump
Collects any memory dump files that exist on the instance.


EC2Config File
Collects log files generated by the EC2Config service.


EC2Launch File
Collects log files generated by the EC2Launch scripts.


SSM Agent File
Collects log files generated by SSM Agent.


Sysprep Log
Collects log files generated by the Windows System Preparation tool.


Driver SetupAPI Log
Collects Windows SetupAPI logs (setupapi.dev.log and setupapi.setup.log).


Registry
Collects SYSTEM and SOFTWARE hives.


System Information
Collects MSInfo32.


Boot Configuration
Collects HKEY_LOCAL_MACHINE\BCD00000000 hive.


Windows Update Log
Collects information about the updates that are installed on the instance.  Windows Update logs are not captured on Windows Server 2016 and later instances.



Video walkthrough
Brandon shows you how to use the Diagnose and Rescue feature of EC2Rescue for Windows Server:

Analyzing an offline instance
The Offline Instance option is useful for debugging boot issues with Windows instances.
To perform an action on an offline instance

From a working Windows Server instance, download the EC2Rescue for Windows Server tool and extract the files.

You can run the following PowerShell command to download EC2Rescue without changing your Internet Explorer Enhanced Security Configuration (ESC):
PS C:\> Invoke-WebRequest https://s3.amazonaws.com/ec2rescue/windows/EC2Rescue_latest.zip -OutFile $env:USERPROFILE\Desktop\EC2Rescue_latest.zip
This command will download the EC2Rescue .zip file to the desktop of the currently logged in user.


Stop the faulty instance, if it is not stopped already.


Detach the EBS root volume from the faulty instance and attach the volume to a working Windows instance that has EC2Rescue for Windows Server installed.


Run the EC2Rescue for Windows Server tool on the working instance and choose Offline Instance.


Select the disk of the newly mounted volume and choose Next.


Confirm the disk selection and choose Yes.


Choose the offline instance option to perform and choose Next.


The EC2Rescue for Windows Server tool scans the volume and collects troubleshooting information based on the selected log files.
Collecting data from an active instance
You can collect logs and other data from an active instance.
To collect data from an active instance


Connect to your Windows instance.


Download the EC2Rescue for Windows Server tool to your Windows instance and extract the files.


You can run the following PowerShell command to download EC2Rescue without changing your Internet Explorer Enhanced Security Configuration (ESC):
PS C:\> Invoke-WebRequest https://s3.amazonaws.com/ec2rescue/windows/EC2Rescue_latest.zip -OutFile $env:USERPROFILE\Desktop\EC2Rescue_latest.zip
This command will download the EC2Rescue .zip file to the desktop of the currently logged in user.


Open the EC2Rescue for Windows Server application and accept the license agreement.


Choose Next, Current instance, Capture logs.


Select the data items to collect and choose Collect.... Read the warning and choose Yes to continue.


Choose a file name and location for the ZIP file and choose Save.


After EC2Rescue for Windows Server completes, choose Open Containing Folder to view the ZIP file.


Choose Finish.

