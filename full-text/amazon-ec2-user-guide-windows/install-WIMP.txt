Tutorial: Installing a WIMP server on an Amazon EC2 instance running Windows Server
This tutorial shows you how to install a Microsoft Internet Information Services (IIS) web server with PHP and MySQL on an EC2 instance running Windows Server. This software configuration is sometimes called a WIMP server or WIMP stack (Windows, IIS, MySQL, PHP).
A WIMP stack is designed for easy installation to help developers get up and running quickly. It is not designed for production environments for the following reasons:
 The default configurations do not meet security requirements for most production environments.
 Upgrading and patching the different software components on a single production server would affect server availability.
 The WAMP one-click installers do not place files in standard locations, which can make it difficult to locate important configuration files.
You can, however, create a WIMP stack on an EC2 instance to prototype a web project in a controlled test environment. For example, you can host a static website or deploy a dynamic PHP application that reads and writes information to a database.
Prerequisites

Provision a Windows Server 2008 R2 or 2012 R2 base instance. You must configure the base instance with a public domain name system (DNS) name that is reachable from the Internet. For more information, see Tutorial: Getting started with Amazon EC2 Windows instances.
Verify that the security group for your instance has the following ports open:
Port 80 (HTTP inbound and outbound) - Allows computers outside of the instance to connect by using HTTP. 
Port 443 (HTTPS inbound and outbound) - Allows computers outside of the instance to connect by using HTTPS.
Port 3389 (RDP inbound only) - Allows you to connect to the instance using Remote Desktop Protocol (RDP). As a security best practice, restrict RDP access to a range of IP addresses in your organization.
Read the best practices for installing PHP on the Microsoft web platform.

Prepare your instance
To prepare your instance


Connect to your instance using Microsoft Remote Desktop. For more information, see Connecting to your Windows instance.


Disable Internet Explorer Enhanced Security Configuration so that you can download and install required software from the web.


From the instance, open Server Manager.


[Windows Server 2008 R2] Under Server Summary, Security Information, choose Configure IE ESC.
[Windows Server 2012 R2] Choose Local Server in the left pane. In the Properties pane, locate IE Enhanced Security Configuration. Choose On.


Under Administrators, choose Off, and then choose OK.


Close Server Manager.
Note
Make a note to re-enable Internet Explorer Enhanced Security Configuration when you have finished installing software from the web.


Install software updates to ensure that the instance has the latest security updates and bug fixes.


EC2Config - Download and install the latest version of the EC2Config service. For more information about how to install this service, see Installing the Latest Version of EC2Config.


Windows Update - Run Windows Update to ensure that the latest security and software updates are installed on the instance. In Control Panel, choose System and Security. In the Windows Update section, choose Check for updates.


Install the IIS web server
IIS is a feature of Windows Server and is installed by using Server Manager. The procedure you'll use depends on the version of Windows Server your instance is running.
Install IIS on Windows Server 2012


On your Windows instance, choose Start, Server Manager, and then choose Add roles and features.


On the Before you begin page, choose Next.


On the Select installation type page, choose Role-based or feature-based installation, and then choose Next.


On the Select destination server page, select your instance from the server pool, and then choose Next.


On the Select server roles page, select Web Server (IIS), choose Add Features, and then choose Next.


On the Select features page, retain the default features and expand .NET Framework 4.5 Features, choose ASP.NET 4.5, and then choose Next.


On the Web Server Role (IIS) page, choose Next.


On the Select role services page, retain the default services and select Application Development.


Expand Application Development, and then select the following features. When selecting these features, if prompted, choose Add Features:


.NET Extensibility 3.5


.NET Extensibility 4.5


Application Initialization


ASP.NET 3.5


ASP.NET 4.5


CGI


Choose Next.


On the Confirm installation selections page, select Restart the destination server automatically if required. When prompted for confirmation, choose Yes. 


Choose Install, and then after the installation is complete, choose Close.


Run Windows update again.


Install IIS on Windows Server 2008


On your Windows instance, choose Start, Server Manager, and then choose Roles.


Choose Add Roles.


On the Before You Begin page, choose Next.


On the Select Server Roles page, choose Web Server (IIS).


On the Select Role Services page under Application Development, choose ASP.NET. 


When prompted, choose Add Required Role Services.


Choose CGI.


Choose Next.


On the Confirm Installation Selections, choose Install.


Run Windows update again.


To verify that the web server is running
After setup completes, verify that the IIS web server is configured properly and running by going to the IIS welcome page. Open a web browser on a different computer and enter either the public DNS address of the WIMP server or the public IP address. The public DNS address for your instance is listed on the Amazon EC2 console in the Public DNS column. If this column is hidden, choose the Show/Hide icon and choose Public DNS.
Important
If you do not see the Bitnami test page, use Windows Firewall with Advanced Security to create a custom rule that allows the HTTP protocol through port 80 and the HTTPS protocol through port 443. For more information, see Network Security on Microsoft TechNet. Also verify that the security group for your instances contains a rule to allow connections on HTTP (port 80). For more information, see Adding rules to a security group.
Install MySQL and PHP
You can download and install MySQL and PHP using the Microsoft Web Platform Installer.
To install MySQL and PHP


In your Windows Server instance, download and install the latest version of the Microsoft Web Platform Installer 5.0.


In the Microsoft Web Platform Installer, choose the Products tab.


Choose MySQL Windows 5.5 and then choose Add.


Choose PHP 5.6.0 and then choose Add.


Choose Install.


On the Prerequisites page, enter a password for the MySQL default database administrator account, and then choose Continue.


When the installation is complete, choose Finish, and then choose Exit to close the Web Platform Installer.


Test your server
Test your server by viewing a PHP file from the web. You must be logged onto the instance as an administrator to perform the following steps. 
To test your WIMP server


Download and install the Visual C Redistributable for Visual Studio 2012 Update 4 x86 package. Even if your server is a 64-bit server, you must install the x86 package.


Create a file named phpinfo.php that contains the following code and place this file in the IIS root directory. By default, the path is: C:\inetpub\wwwroot.


<?php phpinfo(); ?>


In a web browser, enter the URL of the file you just created. This URL is the public DNS address of your instance followed by a forward slash and the file name, as in the following example: http://my.public.dns.amazonaws.com/phpinfo.php.


Verify that the PHP information page is displayed. If the page does not display, verify that you entered the correct public DNS address. Also verify that Windows folder options are configured to show known file extensions. By default, folder options hide known file extensions. If you created the file in Notepad and saved it in the root directory your phpinfo.php file might incorrectly be saved as phpinfo.php.txt.


As a security best practice, delete the phpinfo.php file when you finish testing the WAMP server.


Enhance MySQL security by disabling default features and by setting a root password. The mysql_secure_installation Perl script can perform these tasks for you. To run the script, you must install Perl.


Download and install Perl from the Perl Programming Language website.


In the C:\Program Files\MySQL\MySQL Server 5.5\bin directory, double-click mysql_secure_installation.


When prompted, enter the current root password and press Enter.


Type n to skip changing the password.


Type Y to remove the anonymous user accounts.


Type Y to disable remote root login.


Type Y to remove the test database.


Type Y to reload the privilege tables and save your changes.


You should now have a fully functional WIMP web server. If you add content to the IIS document root at C:\inetpub\wwwroot, you can view that content at the public DNS address for your instance.
Important
As a best practice, stop the MySQL server if you do not plan to use it right away. You can restart the server when you need it again.