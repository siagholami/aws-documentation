Creating an AWS Lambda Function
You can call Amazon Textract API operations from within an AWS Lambda function. The following instructions show how to create a Lambda function in Python that calls DetectDocumentText. It returns a list of Block objects. To run this example, you need an Amazon S3 bucket that contains a document in PNG or JPEG format.
For an example that uses Lambda functions to process documents at a large scale, see Large scale document processing with Amazon Textract.
Step 1: Create an AWS Lambda deployment package


Open a command window.


Enter the following commands to create a deployment package with the most recent version of the AWS SDK.


pip install boto3 --target python/.
   zip boto3-layer.zip -r python/
Step 2: Create a AWS Lambda function (console)


Sign in to the AWS Management Console and open the AWS Lambda console at https://console.aws.amazon.com/lambda/.


Select Create function. For more information, see Create a Lambda Function with the Console.


Choose the following options.
    Choose Author from scratch 
    Enter a value for Function name.
    For Runtime choose Python 3.7 or Python 3.6.
    For Choose or create an execution role, choose Create a new role with basic Lambda permissions. 


Choose Create function to create the AWS Lambda function.


Open the IAM console at https://console.aws.amazon.com/iam/.


From the navigation pane choose Roles.


From the resources list, choose the IAM role that AWS Lambda created for you. The role name is prepended with the name of your Lambda function.


In the Permissions tab, choose Attach policies.


Add the AmazonTextractFullAccess and AmazonS3ReadOnlyAccess Policies.


Select Attach Policy.


Step 3: Create and add a layer (console)


Open the AWS Lambda console at https://console.aws.amazon.com/lambda/.


In the navigation pane, choose Layers. 


Choose Create layer.


Enter values for Name and Description.


For Code entry type, choose Upload .zip file and select Upload.


In the dialog box, select the zip file (boto3-layer.zip) that you created in Step 1: Create an AWS Lambda deployment package.


For compatible runtimes, choose the runtime that you chose in Step 2: Create a AWS Lambda function (console).


Choose Create to create the layer.


Choose the navigation pane menu icon.


In the navigation pane, choose Functions.


In the resources list, select the function you created in Step 2: Create a AWS Lambda function (console). 


In the Designer section of the Configuration tab, choose Layers (under your Lambda function name). 


In the Layers section, choose Add a layer.


Choose Select from list of runtime compatible layers.


In Compatible layers, select the Name and Version of the layer name and version you created in step 3.


Choose Add.


Step 4: Add python code (console)


In Designer choose your function name.


In the function code editor, add the the following to the file lambda_function.py. Change the values of bucket and document to your bucket and document.


```
   import json
   import boto3
def lambda_handler(event, context):
   bucket="bucket"
   document="document"
   client = boto3.client('textract')



   #process using S3 object
   response = client.detect_document_text(
       Document={'S3Object': {'Bucket': bucket, 'Name': document}})

   #Get the text blocks
   blocks=response['Blocks']

   return {
       'statusCode': 200,
       'body': json.dumps(blocks)
   }

```

Choose Save to save your Lambda function.

Step 5: Test your Lambda function (console)


Select Test.


Enter a value for Event name.


Choose Create.


Choose Test. The lambda function is invoked. The output is displayed in the Execution results pane of the code editor. The output is a list of Block objects.


If the AWS Lambda function returns a timeout error, a call to an Amazon Textract API operation might be the cause. For information about extending the timout period for an AWS Lambda function, see AWS Lambda Function Configuration.
For information about invoking a Lambda function from your code, see Invoking AWS Lambda Functions. 