# Text\-to\-Speech Cloud Gem Portal<a name="cloud-canvas-cloud-gem-text-to-speech-cgp"></a>

The Text\-to\-Speech Cloud Gem Portal \(CGP\) is a simple web interface that you can use to create text\-to\-speech \(TTS\) functionality for your game\. This topic shows you how to perform the following tasks:
+ Add a character and specify a name, language, voice, and speech marks for it\.
+ Add a speech line for the character\.
+ Preview the audio and lip synchronization for the speech line, which is added to your speech library\.
+ Add custom tags to your speech lines that you can use to filter searches of your speech library\.
+ Create a `.csv` file with multiple speech lines\.
+ Import the file into the Cloud Gem Portal for processing\.
+ Download a `.zip` package of the voice and speech mark files generated by Amazon Polly\.
+ Use the lmbr\_aws command to import the generated voice packages into your project\.

You can also configure whether game clients can request the generation of speech files and whether to cache them for more than a day\. For more information, see [Configuring Runtime Capabilities and Caching](cloud-canvas-cloud-gem-text-to-speech-runtime.md) \.

**Contents**
+ [Prerequisites](#cloud-canvas-cloud-gem-text-to-speech-cgp-prerequisites)
+ [Using the Text to Speech Cloud Gem Portal](#cloud-canvas-cloud-gem-text-to-speech-cgp-using-the-text-to-speech-gem-cloud-gem-portal)

## Prerequisites<a name="cloud-canvas-cloud-gem-text-to-speech-cgp-prerequisites"></a>

This tutorial assumes that you have already performed the following steps to set up the Cloud Gem Portal \(CGP\) and the Text\-to\-Speech cloud gem:
+ You are using a Lumberyard Editor project that has the Text\-to\-Speech gem enabled\.
+ You used [Cloud Canvas Resource Manager](cloud-canvas-ui-rm-overview.md) to create a project stack and a deployment stack in an [Amazon Polly supported AWS region](https://docs.aws.amazon.com/general/latest/gr/rande.html#pol_region)\.
+ You opened the Cloud Gem Portal\. In Lumberyard Editor, choose **AWS**, **Open Cloud Gem Portal**\.

If you don't meet the prerequisites, follow the steps in [Enabling Gems](gems-system-using-project-configurator.md) to add **Cloud Gem Text\-to\-Speech** in the Project Configurator\. For information on creating a project and deployment stacks, see [Tutorial: Getting Started with Cloud Canvas](cloud-canvas-tutorial.md)\.

## Using the Text to Speech Cloud Gem Portal<a name="cloud-canvas-cloud-gem-text-to-speech-cgp-using-the-text-to-speech-gem-cloud-gem-portal"></a>

In the Cloud Gem Portal, on the **Cloud Gems** page, choose **Text to Speech**\.

![\[Choose Text to Speech in the Cloud Gem Portal.\]](http://docs.aws.amazon.com/lumberyard/latest/userguide/images/cloud_canvas/cloud-canvas-cloud-gem-text-to-speech-cgp-1.png)

The initial portal includes a **Speech Library**, **Characters**, and **Generated Packages** tabs\. These are the only tabs that you need to get started\. For information about the other tabs, see [Configuring Runtime Capabilities and Caching](cloud-canvas-cloud-gem-text-to-speech-runtime.md) and [Text\-to\-Speech Troubleshooting Features](cloud-canvas-cloud-gem-text-to-speech-details.md#cloud-canvas-cloud-gem-text-to-speech-details-troubleshooting)\.

![\[Text to Speech Cloud Gem initial screen\]](http://docs.aws.amazon.com/lumberyard/latest/userguide/images/cloud_canvas/cloud-canvas-cloud-gem-text-to-speech-cgp-2.png)

You can use the Text to Speech Cloud Gem Portal to create speech character content in a variety of ways\. Use the workflow that suits you best\. The following are some example workflows:
+ You create characters on the **Characters** tab with the voice and language characteristics that you want\. Then use the **Speech Library** tab to create speech lines for the characters\.
+ You create the speech lines that you want on the **Speech Library** tab\. Then use the **Characters** tab to modify the default character that the cloud gem created for you for the speech lines\.
+ You use the **Speech Library** tab to import speech lines from a `.csv` file that you created\. The file can specify characters that you have already created in the portal, or you can let the cloud gem portal specify a default character for your speech lines\.

### Adding a Character<a name="cloud-canvas-cloud-gem-text-to-speech-cgp-adding-a-character"></a>

A text\-to\-speech character is defined by a name that you give the character, the language that the character speaks, and the male or female voice that the character uses\. It can also have speech mark files that contain lip sync, closed captioning, and [Speech Synthesis Markup Language](https://developer.amazon.com/docs/custom-skills/speech-synthesis-markup-language-ssml-reference.html) \(SSML\) tags\.

**To add a character**

1. On the **Characters** tab of the Cloud Gem Portal, choose **New Character** to add a character to the characters table\.   
![\[Choose New Character in the Cloud Gem Portal\]](http://docs.aws.amazon.com/lumberyard/latest/userguide/images/cloud_canvas/cloud-canvas-cloud-gem-text-to-speech-cgp-3.png)

1. In the fields that appear, specify the following for the character\.
   + **Name** – By default, the new character is named *NewCharacter\_*<total number of rows in the characters table>**\. Type a name for the character that has meaning in the context of your game\.
   + **Language** – Choose the language that the character uses\. You can choose from more than 20 languages\. For a complete list of Amazon Polly languages and their corresponding voices, see [Available Voices](https://docs.aws.amazon.com/polly/latest/dg/voicelist.html) in the *Amazon Polly Developer Guide*\.
   + **Voice** – Choose the name of the Amazon Polly male or female voice that you want for your character\.
   + **Speech Marks** – You can select the following options\. These options are enabled by default\. 
     + **SSML** to generate speech synthesis markup language tags\.
     + Select **Viseme** to generate lip syncing information for the speech lines that you create\.
     +  Select **Sentence/Word** to generate closed captioning information\.

1. Choose **Save**\.

1. Choose **Preview** to hear the voice that you selected say, "Hi\. My name is *<name>*\."

**Note**  
The next time that you add a character, the new character entry appears first in the list of characters\. The values for a new character default to the values that you provided for the previous character\.

### Editing a Character<a name="cloud-canvas-cloud-gem-text-to-speech-cgp-editing-a-character"></a>

After you create a character, you can edit it with the following steps\.

**To edit a character**

1. Click an editable field to update it, and then choose **Save**\.  
![\[Edit fields inline for an existing character in the Cloud Gem Portal.\]](http://docs.aws.amazon.com/lumberyard/latest/userguide/images/cloud_canvas/cloud-canvas-cloud-gem-text-to-speech-cgp-editing-a-character-inline.png)

1. To alter the character's voice, choose the gear ![\[Image NOT FOUND\]](http://docs.aws.amazon.com/lumberyard/latest/userguide/images/shared/cloud-canvas-cloud-gem-text-to-speech-cgp-4.png) icon near **Preview**\.

   1. Use the **Advanced Settings** dialog box to adjust the **Volume**, **Rate**, **Pitch**, and **Timbre** of the voice\. 

   1. Use the **Language Override** option to override the **Native Language** setting and have the character speak with a rendered accent\.   
![\[Advanced settings for changing a character's voice in the Cloud Gem Portal.\]](http://docs.aws.amazon.com/lumberyard/latest/userguide/images/cloud_canvas/cloud-canvas-cloud-gem-text-to-speech-cgp-5-new.png)

Now you are ready to add a speech line to give the character something to say\.

### Adding a Speech Line<a name="cloud-canvas-cloud-gem-text-to-speech-cgp-adding-a-speech-line"></a>

You can create speech lines one at a time in the Cloud Gem Portal\.

**To add an individual speech line**

1. In the Cloud Gem Portal, choose the **Speech Library** tab\.

1. Choose **New Speech Line\.**  
![\[Adding a speech line for your character in the Cloud Gem Portal.\]](http://docs.aws.amazon.com/lumberyard/latest/userguide/images/cloud_canvas/cloud-canvas-cloud-gem-text-to-speech-cgp-6.png)

1. Specify the following for the speech line\.
   + **Character** – Choose the character that will speak the speech line\. You can choose from the characters that you created on the **Characters** tab\.
   + **Speech Line** – Replace the default *NewSpeechLine\_*<total number of rows in table>** with the text that you want to convert to speech\.
   + **Preview** – Choose the **Preview** icon to hear an audio preview of your text\. If you selected the **Viseme** option for the character that you are using, the facial rig performs lip synchronization as well\.
   + **Tags** – You can use custom tags to categorize your speech lines\. You can use these tags to filter the speech lines that you want to view in the Cloud Gem Portal\. To add one or more tags, enter the tag name and then press **Enter** after each tag\. 
**Warning**  
Do not store sensitive customer information in speech lines or character definitions\.

1. Choose **Save**\.

**Note**  
The next time that you add a speech line, the new line appears first in the speech library\. The **Character** and **Tag** values for the new speech line default to the values that you provided for the speech line that you last created\.

### Filtering Speech Lines<a name="cloud-canvas-cloud-gem-text-to-speech-cgp-filtering-speech-lines"></a>

After you create multiple speech lines, click the filter ![\[Image NOT FOUND\]](http://docs.aws.amazon.com/lumberyard/latest/userguide/images/cloud_canvas/cloud-canvas-cloud-gem-text-to-speech-cgp-filter-icon.png) icon for **Character** or **Tags** to filter them\.

![\[Character and tag filters for speech lines.\]](http://docs.aws.amazon.com/lumberyard/latest/userguide/images/cloud_canvas/cloud-canvas-cloud-gem-text-to-speech-cgp-filters.png)

In the filter dialog box, select the characters or tags that you want to filter for, and then choose **Apply**\.

![\[Filtering by character\]](http://docs.aws.amazon.com/lumberyard/latest/userguide/images/cloud_canvas/cloud-canvas-cloud-gem-text-to-speech-cgp-7a-character-filter.png)

![\[Filtering by tags\]](http://docs.aws.amazon.com/lumberyard/latest/userguide/images/cloud_canvas/cloud-canvas-cloud-gem-text-to-speech-cgp-7b-tag-filter.png)

For the tag filter, you can use the **Match** option to filter for **Any** or **All** of the tags that you select\.

### Deleting Speech Lines<a name="cloud-canvas-cloud-gem-text-to-speech-cgp-deleting-speech-lines"></a>

You can delete speech lines one at a time or in multiples\.

**To delete a single speech line**
+ Click the trash icon for the speech line\. 

![\[Deleting a speech line in the Cloud Gem Portal.\]](http://docs.aws.amazon.com/lumberyard/latest/userguide/images/cloud_canvas/cloud-canvas-cloud-gem-text-to-speech-cgp-deleting-speech-lines-single.png)

**To delete a multiple speech lines**
+ Select the speech lines that you want to delete, and then choose **Delete**\.

![\[Deleting multiple speech lines in the Cloud Gem Portal.\]](http://docs.aws.amazon.com/lumberyard/latest/userguide/images/cloud_canvas/cloud-canvas-cloud-gem-text-to-speech-cgp-deleting-speech-lines-multiple.png)

### Importing Speech Lines from a \.csv File<a name="cloud-canvas-cloud-gem-text-to-speech-cgp-importing-speech-lines"></a>

Instead of creating your speech lines one by one in the Cloud Gem Portal, you can prepare a `.csv` file that contains all of the lines that you require\. You can then use the Cloud Gem Portal to import the file\.

#### Creating a Speech Line File<a name="cloud-canvas-cloud-gem-text-to-speech-cgp-creating-a-speechline-file"></a>

To create a speechline file in `.csv` format, see the following example\. The example has rows that specify fields for character, speech line, time of day, mood, and stimulus\.

```
Character,Speech Line,Time of Day,Mood,Stimulus
Jane,Good Morning! How are you?,Morning,Happy,
John,You stepped on my toe!,Afternoon,Angry,footSteppedOn
Mary,Welcome to the Text to Speech Cloud Gem.,Night,Happy,
Richard,Thank you for your help.,Afternoon,Happy,directionsReceived
```

The CGP treats the first line in the file as a header row\. The second and following rows are data rows\. Each data row should specify a character name and a line of speech for the character\. A data row can have other fields that have meaning in the context of your game\. You can map these fields to custom tags when you import the file\.

#### Importing a Speech Line File<a name="cloud-canvas-cloud-gem-text-to-speech-cgp-importing-a-speechline-file"></a>

See the following steps to import a speech line file\.

**To import a `.csv` speech line file**

1. On the **Speech Library** tab, choose **Import \.csv**\., and then choose the `.csv` file to import\.

1. In the **Import** window, choose your custom mappings, and then choose **Continue**\.  
![\[Mapping fields in the speech line .csv file.\]](http://docs.aws.amazon.com/lumberyard/latest/userguide/images/cloud_canvas/cloud-canvas-cloud-gem-text-to-speech-cgp-8.png)

1. Select the speech lines that you want to import, or select the check box at the top to import them all\.  
![\[Choosing speech lines to import from a .csv file.\]](http://docs.aws.amazon.com/lumberyard/latest/userguide/images/cloud_canvas/cloud-canvas-cloud-gem-text-to-speech-cgp-9.png)

1. Choose **Continue**\. The imported lines appear in the speech library, where you can edit them as needed\.  
![\[Imported speech lines\]](http://docs.aws.amazon.com/lumberyard/latest/userguide/images/cloud_canvas/cloud-canvas-cloud-gem-text-to-speech-cgp-10.png)
**Note**  
If the character for a speech line does not exist, the cloud gem creates one based on the values of the last character that you created\.

### Downloading Speech Files<a name="cloud-canvas-cloud-gem-text-to-speech-cgp-downloading-speech-files"></a>

After you use the Cloud Gem Portal to create your speech line/character combinations in the AWS cloud, you can download a `.zip` file package of the files that were generated\. You can then import the voice package into your project assets\.

**To download speech files**

1. In the Cloud Gem Portal, choose the **Speech Library** tab, select the speech lines that you want to download, and then choose **Download Speech Files \(\.zip\)**\.  
![\[Downloading speech files in the Cloud Gem Portal.\]](http://docs.aws.amazon.com/lumberyard/latest/userguide/images/cloud_canvas/cloud-canvas-cloud-gem-text-to-speech-cgp-11.png)

1. Enter a name for the `.zip` file, and then choose **Download**\.  
![\[File name for download\]](http://docs.aws.amazon.com/lumberyard/latest/userguide/images/cloud_canvas/cloud-canvas-cloud-gem-text-to-speech-cgp-12.png)

   To ensure uniqueness, a UUID is added to the file name that you specify\. The final file name format is `<file_name><UUID>.zip`\.

1. If your speech package is large, it can take some time to download\. To check the status of a pending download, choose the cloud icon ![\[Image NOT FOUND\]](http://docs.aws.amazon.com/lumberyard/latest/userguide/images/cloud_canvas/cloud-canvas-cloud-gem-text-to-speech-cgp-13.png) next to **Download Speech Files \(\.zip\)**\.  
![\[View pending speech file downloads in the Cloud Gem Portal.\]](http://docs.aws.amazon.com/lumberyard/latest/userguide/images/cloud_canvas/cloud-canvas-cloud-gem-text-to-speech-cgp-14.png)

1. You can open the `.zip` file to view its contents\. The file contains the voice \(`.pcm`\) files, the speech mark `(.json`\) files, and a `character_mapping.json` file\. It also contains a `speech_line_definitions.csv` file that contains the definitions of the speech lines that you selected\.  
![\[Viewing downloaded contents of the speech file.\]](http://docs.aws.amazon.com/lumberyard/latest/userguide/images/cloud_canvas/cloud-canvas-cloud-gem-text-to-speech-cgp-15.png)

   Several speech lines can share a voice file if they use the same voice and speech line\. They can also share a speech marks file if they are using the same voice, speech line, and speech marks\.

### Downloading Generated Packages<a name="cloud-canvas-cloud-gem-text-to-speech-cgp-downloading-generated-packages"></a>

When you download a speech file, a copy is saved on the **Generated Packages** tab\. This creates a repository of generated packages that you can download again if needed\.

![\[Downloading generated packages\]](http://docs.aws.amazon.com/lumberyard/latest/userguide/images/cloud_canvas/cloud-canvas-cloud-gem-text-to-speech-cgp-16a.png)

**To download a generated package**
+ Select the packages that you want, and then choose **Download Generated Packages**\.

**To delete a generated package**
+ Choose the trash icon for the package\.

### Importing the Generated Voice Packages Into Your Project<a name="cloud-canvas-cloud-gem-text-to-speech-cgp-importing-the-generated-voice-packages-into-your-project"></a>

After you download the voice packages that you generated, you can import them into your project\. This removes the need for the client to connect to Amazon Polly to generate and download lines that you already know the player will require\. The benefit is lower cost and faster response time\. The disadvantage is that the client must store the files locally\.

**To import a voice package**
+ In the `\dev` directory, enter the following lmbr\_aws command :

  ```
  lmbr_aws cloud-gem-tts import-tts-zip --download-path absolute_path
  ```

The `download-path` argument is the absolute path to the `.zip` file that you downloaded\. Optionally, you can use the `--import-as-wav` argument to convert the `.pcm` files to `.wav` files so that you can import them into Wwise or other audio solutions\.

The Lumberyard Asset Processor processes the imported files and adds them to your game project\.