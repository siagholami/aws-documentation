# Researching S3 Objects Data<a name="s3objectsdata"></a>

**Topics**
+ [Analyzing S3 Objects Search Results](#s3searchresults)
+ [S3 Objects Data Fields and Sample Queries](#s3fields)

## Analyzing S3 Objects Search Results<a name="s3searchresults"></a>

The following section describes the elements of the search results that get displayed when you use the **Research** tab to investigate your S3 objects that Macie monitors\. 

Complete the following steps in the **Research** tab\.

1. Select **S3 objects** in the first filter pull\-down list\.

1. For this sample procedure, select **Top 10** in the second filter dropdown\.

1. For this sample procedure, select **Past 90** days in the third filter dropdown\.

1. Choose the button with the looking glass icon to start the search\.

Your search results include the following elements:
+ The **total number of results** that matched your S3 objects search for the selected time range\.
+ The **graphical representation** of the S3 objects search results for the selected time range\.
**Note**  
If your dataset is very large and you specify a very wide time range, your data might not render properly, and this graph might not appear as one of the resulting elements of your search\.
**Important**  
You can use the graph to further narrow your search and generate and run a query that produces a subset of the results generated by your original selections in the preceding steps\. Double\-click any of the graph's results, and your selection is translated into a new query that automatically appears in the query parser, and the **Research** tab is refreshed with the results of this new query\. 
+ **Search results summary** â€“ A list of the most significant fields from your search\. The first line includes the top \(or bottom\) three values for each field\. The second line includes the top \(or bottom\) 10 values for each field\.
**Important**  
You can use the fields in the search results summary to further narrow your search and generate and run a query that produces a subset of the results generated by your original selections in the preceding steps\. Choose the first or the second line of results for any field, and in the expanded results breakdown, choose the looking glass icon next to any of the results\. Your choices are translated into a new query that automatically appears in the query parser, and the **Research** tab is refreshed with the results of this new query\.
+ A list of S3 objects that match your search criteria\. Choose any S3 object to expand it and view its details\.

## S3 Objects Data Fields and Sample Queries<a name="s3fields"></a>

The following tables include the fields that can appear in the results of your S3 object searches:
+ The first table includes the fields that Macie extracts from the Amazon S3 object API metadata\. These are Macie fields that are also found in S3 API metadata\. For example, `filesystem_metadata.ETag` describes the entity tag of an S3 object based on the checksum or hash of its content\.
+ The second table includes the fields that Macie generates to provide further security intelligence and context based on the examined S3 objects content and metadata\. For example, `dlp_risk` represents a weighted score describing the risk profile of an S3 object metadata and its content, and `pii_types` describes any personal identifiable information contained in an S3 object\.

### S3 Object Data Fields That Macie Extracts<a name="s3fields_extracted"></a>


| Macie Field Name | Amazon S3 API Field Name | Amazon S3 API Operation | Macie Field Type | Description | Example Search Query | 
| --- | --- | --- | --- | --- | --- | 
| `key` | `key` | `get-bucket` \(`listObjects`\)  | String   | The S3 object key path\. | Search for document names with the keyword "myobject": [\[See the AWS documentation website for more details\]](http://docs.aws.amazon.com/macie/latest/userguide/s3objectsdata.html)  | 
| `accountId` | None | None  |  String | The AWS account ID that owns the S3 object\. | Search for S3 objects owned by a particular account ID:  [\[See the AWS documentation website for more details\]](http://docs.aws.amazon.com/macie/latest/userguide/s3objectsdata.html)  | 
| `filesystem_metadata.bucket` | None | None  | String | The S3 bucket name that holds the S3 object\. | Search for S3 objects in a particular S3 bucket:  [\[See the AWS documentation website for more details\]](http://docs.aws.amazon.com/macie/latest/userguide/s3objectsdata.html)  | 
| `filesystem_metadata.first_prefix` | None  Macie uses the S3 key field and parses out everything before the first '/', not including the bucket name\.   | `get-bucket` \(`listObjects`\)  | String | The name of the first folder that contains the S3 object\. | Search for S3 objects contained in first folder names where folder name is `AWSLogs`:  [\[See the AWS documentation website for more details\]](http://docs.aws.amazon.com/macie/latest/userguide/s3objectsdata.html)  | 
| `filesystem_metadata.ETag` | `eTag` | `get-bucket` \(`listBuckets`\) | String | The entity tag as defined in RFC 2616\.   | Search for a particular `eTag`:  [\[See the AWS documentation website for more details\]](http://docs.aws.amazon.com/macie/latest/userguide/s3objectsdata.html)  | 
| `filesystem_metadata.bucket_owner.id` | `ID` | `get-bucket-acl` | String | The unique ID of the S3 bucket owner\.  | Search for S3 objects belonging to a particular owner ID:  [\[See the AWS documentation website for more details\]](http://docs.aws.amazon.com/macie/latest/userguide/s3objectsdata.html)  | 
| `filesystem_metadata.bucket_owner.name` | `Owner` | `get-bucket-acl` | String | The name of the S3 bucket owner\.  | Search for S3 objects owned by John Doe:  [\[See the AWS documentation website for more details\]](http://docs.aws.amazon.com/macie/latest/userguide/s3objectsdata.html)  | 
| `filesystem_metadata.last_modified` | `LastModified` | `get-bucket` \(`list-buckets`\) | Date | The timestamp when the S3 object was last modified\.  | Search for S3 objects that were modified in the last 24 hours:  [\[See the AWS documentation website for more details\]](http://docs.aws.amazon.com/macie/latest/userguide/s3objectsdata.html)  | 
| `filesystem_metadata.server_encryption` | `ServerSideEncryption` | `get-object`  | String | The server side encryption used to encrypt an S3 object\.  | Search for objects that aren't encrypted with the AES256 standard:  [\[See the AWS documentation website for more details\]](http://docs.aws.amazon.com/macie/latest/userguide/s3objectsdata.html)  | 
| `filesystem_metadata.size` | `Size` | `get-bucket` \(`list-buckets`\)  | Integer | The size of the S3 object's content in bytes\.  | Search for S3 objects that are larger than 1 MB:  [\[See the AWS documentation website for more details\]](http://docs.aws.amazon.com/macie/latest/userguide/s3objectsdata.html)  | 
| `filesystem_metadata.sse_kms_key_id` | `SSEKMSKeyId` | `get-object` | String | The unique identifier \(ARN\) of the master key used for server side encryption of the S3 objects\.  | Search for all S3 objects encrypted with a given key ID:  [\[See the AWS documentation website for more details\]](http://docs.aws.amazon.com/macie/latest/userguide/s3objectsdata.html)  | 
| `object_acl.Grants.Grantee.DisplayName` | `Grants.Grantee.DisplayName` | `get-object-acl` | String | The ACL grantee name\.  | Search for S3 object ACL permissions granted to John Doe:  [\[See the AWS documentation website for more details\]](http://docs.aws.amazon.com/macie/latest/userguide/s3objectsdata.html)  | 
| `object_acl.Grants.Grantee.ID` | `Grants.Grantee.ID` | `get-object-acl` | String | The ACL grantee unique ID\.  | Search for S3 object ACL permissions with a particular grantee ID:  [\[See the AWS documentation website for more details\]](http://docs.aws.amazon.com/macie/latest/userguide/s3objectsdata.html)  | 
| `object_acl.Grants.Grantee.Type` | `Grants.Grantee.Type` | `get-object-acl` | String | The ACL grantee type, such as `CanonicalUser` or `Group`\.  | Search for all S3 object ACLs that are granted to users or groups:  [\[See the AWS documentation website for more details\]](http://docs.aws.amazon.com/macie/latest/userguide/s3objectsdata.html)  | 
| `object_acl.Grants.Grantee.URI` | `Grants.Grantee.URI` | `get-object-acl` | String | The ACL grantee URI\.  | Search for S3 object ACLs with the `AllUsers` grant:  [\[See the AWS documentation website for more details\]](http://docs.aws.amazon.com/macie/latest/userguide/s3objectsdata.html)  | 
| `object_acl.Grants.Permission` | `Grants.Permission` | `get-object-acl` | String | The ACL grantee permission\.  | Search for S3 object ACLs that grant full control:  [\[See the AWS documentation website for more details\]](http://docs.aws.amazon.com/macie/latest/userguide/s3objectsdata.html)  | 
| `object_acl.Owner.DisplayName` | `Owner.DisplayName` | `get-object-acl` | String | The ACL owner name\.  | Search for S3 objects owned by John Doe:  [\[See the AWS documentation website for more details\]](http://docs.aws.amazon.com/macie/latest/userguide/s3objectsdata.html)  | 
| `object_acl.Owner.ID` | `Owner.ID` | `get-object-acl` | String | The ACL owner ID\.  |  Search for S3 objects belonging to a particular owner ID:  [\[See the AWS documentation website for more details\]](http://docs.aws.amazon.com/macie/latest/userguide/s3objectsdata.html)  | 

### S3 Object Data FieldsThat Macie Generates<a name="s3fields_macie-generated"></a>


| Macie Field Name | Macie Field Type | Description | Example Search Query | 
| --- | --- | --- | --- | 
| `@timestamp` | Date | The timestamp when the S3 object was last modified\.  | Search for S3 objects classified by Macie in the last 24 hours:  [\[See the AWS documentation website for more details\]](http://docs.aws.amazon.com/macie/latest/userguide/s3objectsdata.html)  | 
| `content_type` | String | The content and encoding type of the S3 object\.   You can locate this value in the **Name** field for a particular content type in the **Content types** section of the Macie console's **Settings** page\.   | Search for java source code containing hard\-coded AWS credentials:  [\[See the AWS documentation website for more details\]](http://docs.aws.amazon.com/macie/latest/userguide/s3objectsdata.html)  | 
| `dlp_risk` | Integer | Through the automatic classification methods, an object monitored by Macie is assigned risk levels based on each content type, file extension, theme, regex, and SVM artifact that is assigned to it\. The object's compound \(final\) risk level \(`dlp_risk`\) is set to the highest value of its assigned risk levels\.   You can find risk levels in the **Settings** page of the Macie console for their respective supported data classifiers\.   | Search for globally accessible \(read or write\) objects with the compound \(final\) risk level of 5 or higher:  [\[See the AWS documentation website for more details\]](http://docs.aws.amazon.com/macie/latest/userguide/s3objectsdata.html)  | 
| `encoding` | String | The encoding scheme identified when analyzing the S3 object content\.  | Search for Unicode text documents:  [\[See the AWS documentation website for more details\]](http://docs.aws.amazon.com/macie/latest/userguide/s3objectsdata.html)  | 
| `filetype_risk` | Integer | The risk level assigned to an S3 object based on its file extension\.  You can find risk levels in the **Settings** page of the Macie console for their respective supported data classifiers\.   | Search for documents with the assigned file extension risk of greater than 6:  [\[See the AWS documentation website for more details\]](http://docs.aws.amazon.com/macie/latest/userguide/s3objectsdata.html)  | 
| `filetypes` | String | The type of the file based on the extension\.  You can locate this value in the **Name** and **Description** fields for a particular file type in the **File extensions** section of the Macie console's **Settings** page\.   | Search for files with an extension of \.pdf:  [\[See the AWS documentation website for more details\]](http://docs.aws.amazon.com/macie/latest/userguide/s3objectsdata.html)  | 
| `keyword_themes` | String | The themes assigned to an S3 object\. You can find supported themes in the Macie console's **Settings** page\.   | Search for S3 objects containing content related to Social Security:  [\[See the AWS documentation website for more details\]](http://docs.aws.amazon.com/macie/latest/userguide/s3objectsdata.html)  | 
| `language_code` | String | The language code found when analyzing the S3 object's content\.  | Search for S3 objects containing German keywords:  [\[See the AWS documentation website for more details\]](http://docs.aws.amazon.com/macie/latest/userguide/s3objectsdata.html)  | 
| `last_crawl_time` | Date | The timestamp of when Macie last analyzed an S3 object\.  | Search for S3 objects analyzed by Macie in the last 24 hours:  [\[See the AWS documentation website for more details\]](http://docs.aws.amazon.com/macie/latest/userguide/s3objectsdata.html)  | 
| `mimetype_risk` | Integer | The risk level based on an S3 object's content / MIME type\.  | Search for S3 objects containing MIME types associated with high\-risk content:  [\[See the AWS documentation website for more details\]](http://docs.aws.amazon.com/macie/latest/userguide/s3objectsdata.html)  | 
| `mimetypes` | String | The MIME type of an S3 object\.  | Search for plaintext documents containing AWS secret keys:  [\[See the AWS documentation website for more details\]](http://docs.aws.amazon.com/macie/latest/userguide/s3objectsdata.html)  | 
| `pii_impact` | String | The PII severity impact of an S3 object, assigned by Macie\.  | Search for S3 objects containing highly valuable personal identifiable information:  [\[See the AWS documentation website for more details\]](http://docs.aws.amazon.com/macie/latest/userguide/s3objectsdata.html)  | 
| `pii_types` | String | The specific type of PII found in an S3 object\.  | Search for S3 objects containing emails:  [\[See the AWS documentation website for more details\]](http://docs.aws.amazon.com/macie/latest/userguide/s3objectsdata.html)  | 
| `regex_risk` | Integer | The risk level based on the regex, assigned by Macie, of an S3 object\.  | Search for S3 objects with a regex\-based risk level greater than 5:  [\[See the AWS documentation website for more details\]](http://docs.aws.amazon.com/macie/latest/userguide/s3objectsdata.html)  | 
| `regex_themes` | String | The regex themes of an S3 object\.  | Search for S3 objects containing RSA private keys  [\[See the AWS documentation website for more details\]](http://docs.aws.amazon.com/macie/latest/userguide/s3objectsdata.html)  | 
| `theme_risk` | String | The risk level based on the themes, assigned by Macie, of an S3 object\.  | Search for S3 objects with a theme\-based risk level higher than 5:  [\[See the AWS documentation website for more details\]](http://docs.aws.amazon.com/macie/latest/userguide/s3objectsdata.html)  | 
| `themes` | String | The combined themes of an S3 object\.  | Search for S3 objects containing RSA private keys:  [\[See the AWS documentation website for more details\]](http://docs.aws.amazon.com/macie/latest/userguide/s3objectsdata.html)  | 