Researching S3 Bucket Properties Data
Topics
 Analyzing S3 Buckets Properties Search Results
 S3 Bucket Properties Data Fields and Example Queries
Analyzing S3 Buckets Properties Search Results
The following section describes the elements of the search results that appear when you use the Research tab to investigate your S3 bucket properties data that Macie monitors.
Complete the following steps in the Research tab.


Select S3 bucket properties in the first filter dropdown.


For this example, select Top 10 in the second filter dropdown.


For this example, select Past 90 days in the third filter dropdown.


Choose the button with the looking glass icon to start the search.


Your search results contain the following elements:
 The total number of results that matched your S3 bucket properties data search for the selected time range.
 The graphical representation of the S3 bucket properties data search results for the selected time range.
Note
If your dataset is very large and you specify a very wide time range, your data might not render properly, and this graph might not appear as one of the resulting elements of your search.
Important
You can use the graph to further narrow your search and generate and run a query that produces a subset of the results generated by your original selections in the preceding steps. Double-click any of the graph's results, and your selection is translated into a new query that automatically appears in the query parser, and the Research tab is refreshed with the results of this new query. 
 Search results summary – A list of the most significant fields from your search. The first line includes the top (or bottom) three values for each field. The second line includes the top (or bottom) 10 values for each field.
Important
You can use the fields in the search results summary to further narrow your search and generate and run a query that produces a subset of the results generated by your original selections in the preceding steps. Choose the first or the second line of results for any field, and in the expanded results breakdown, choose the looking glass icon next to any of the results. Your choices are translated into a new query that automatically appears in the query parser, and the Research tab is refreshed with the results of this new query.
 A list of S3 buckets that match your search criteria. Choose any bucket to expand it and view its details.
S3 Bucket Properties Data Fields and Example Queries
The following tables include the fields that can appear in the results of your S3 buckets metadata searches: 
 The first table includes the fields that Macie extracts from the Amazon S3 bucket API metadata. For example, acl.Grants.Grantee.DisplayName in Macie corresponds to Grants.Grantee.DisplayName in the Amazon S3 getbucket-acl API response.
 The second table includes the fields that Macie generates to provide further security intelligence and context based on the examined S3 buckets metadata. For example, s3_world_readability describes a true/false/unknown state condition of whether an S3 bucket is readable by everyone as part of evaluating its Amazon S3 ACL and bucket (IAM) policy.
S3 Bucket Properties Data Fields That Macie Extracts



Macie Field Name
Amazon S3 API Field Name
Amazon S3 API Operation
Macie Field Type
Description
Example Search Query




acl.Grants.Grantee.DisplayName
Grants.Grantee.DisplayName
get-bucket-acl
String
The display name of the S3 bucket ACL grantee.
Search for S3 buckets accessible by John Doe:  [See the AWS documentation website for more details]


acl.Grants.Grantee.ID
Grants.Grantee.ID
get-bucket-acl
String
The ID of the identity that was granted access to the S3 bucket by the bucket owner.
Search for an S3 bucket's grantee with a particular canonical ID:  [See the AWS documentation website for more details]


acl.Grants.Grantee.Type
Grants.Grantee.Type
get-bucket-acl
String
The user type of the S3 bucket ACL grantee.
Search for all S3 buckets that are granted to Users: [See the AWS documentation website for more details] Search for all S3 buckets that are granted to Groups: [See the AWS documentation website for more details]


acl.Grants.Grantee.URI
Grants.Grantee.URI
get-bucket-acl
String
The URI identifier of the S3 bucket ACL grantee.
Search for all S3 buckets except those that belong to the LogDelivery group: [See the AWS documentation website for more details] Search for all S3 buckets that have global share permissions: [See the AWS documentation website for more details] Search for all S3 buckets that allow access to (any) AWS authenticated users: [See the AWS documentation website for more details]


acl.Grants.Permission
Grants.Permission
get-bucket-acl
String
The permission level assigned to the ACL grantee.
Search for S3 buckets that grant full (read/write) access to anyone:  [See the AWS documentation website for more details]


acl.Owner.DisplayName
Owner.DisplayName
get-bucket-acl
String
The display name of the S3 bucket owner.
Search for S3 buckets owned by John Doe: [See the AWS documentation website for more details]


acl.Owner.ID
Owner.ID
get-bucket-acl
String
The ID of the S3 bucket owner.
Search for a particular S3 bucket owner ID: [See the AWS documentation website for more details]


location.LocationConstraint
LocationConstraint
get-bucket-location
String
The AWS Region where the S3 bucket resides.   By default, buckets in the us-east-1 Region have no region returned from the S3 API call. To facilitate searching, Macie automatically populates them with the string “us-east-1”.
Search for buckets hosted in the us-west-2 Region: [See the AWS documentation website for more details] Search for buckets hosted in the us-east-1 Region: [See the AWS documentation website for more details]


logging.LoggingEnabled.TargetBucket
LoggingEnabled.TargetBucket
get-bucket-logging
String
The bucket whose logging status is being returned.
Search for all buckets with S3 object level logging enabled:  [See the AWS documentation website for more details]


logging.LoggingEnabled.TargetPrefix
LoggingEnabled.TargetPrefix
get-bucket-logging
String
The configured prefix or folder containing Object Level Logging data for a particular S3 bucket.
Search for buckets configured with a prefix substring of "Production":  [See the AWS documentation website for more details]


policy.Policy.Id
Policy.Id
get-bucket-policy
String
The ID for an S3 bucket policy.
Search for bucket policies with a particular ID:  [See the AWS documentation website for more details]


policy.Policy.Statement.Action
Policy.Statement.Action
get-bucket-policy
String
The list of actions (API requests) associated with an S3 bucket policy.
Search for bucket policies with "put" substring actions (PutObject, PubBucketPolicy, etc.): [See the AWS documentation website for more details]


policy.Policy.Statement.Effect
Policy.Statement.Effect
get-bucket-policy
String
The list of policy effects associated with an S3 bucket policy.
Search for bucket policies with explicit "allow" grants:  [See the AWS documentation website for more details]


policy.Policy.Statement.NotPrincipal.AWS
Policy.Statement.NotPrincipal.AWS
get-bucket-policy
String
The principal exception to which the policy rule is applied.
Search for bucket policies with a particular account specified in the NotPrincipal section:  [See the AWS documentation website for more details]


policy.Policy.Statement.NotPrincipal.CanonicalUser
Policy.Statement.NotPrincipal.CanonicalUser
get-bucket-policy
String
The CanonicalUser stated in the NotPrincipal expression of the policy.
Search for bucket policies with a particular CanonicalUser specified in the NotPrincipal section:  [See the AWS documentation website for more details]


policy.Policy.Statement.NotPrincipal.Federated
Policy.Statement.NotPrincipal.Federated
get-bucket-policy
String
The Federated identity stated in the NotPrincipal expression of the policy.
Search for bucket policies with a particular Federated user specified in the NotPrincipal section:  [See the AWS documentation website for more details]


policy.Policy.Statement.NotPrincipal.Service
Policy.Statement.NotPrincipal.Service
get-bucket-policy
String
The Service stated in the NotPrincipal expression of the policy.
Search for bucket policies with a particular Service specified in the NotPrincipal section:  [See the AWS documentation website for more details]


policy.Policy.Statement.Principal.AWS
Policy.Statement.Principal.AWS
get-bucket-policy
String
The principal specified in the AWS expression.
Search for bucket policies with explicit allow grants to any AWS resource:  [See the AWS documentation website for more details]


policy.Policy.Statement.Principal.CanonicalUser
Policy.Statement.Principal.CanonicalUser
get-bucket-policy
String
The CanonicalUser stated in the principal expression of the policy.
Search for bucket policies with a particular CanonicalUser specified in the Principal section:  [See the AWS documentation website for more details]


policy.Policy.Statement.Principal.Federated
Policy.Statement.Principal.Federated
get-bucket-policy
String
The Federated identity stated in the principal expression of the policy.
Search for bucket policies with a particular Federated user specified in the NotPrincipal section:  [See the AWS documentation website for more details]


policy.Policy.Statement.Principal.Service
Policy.Statement.Principal.Service
get-bucket-policy
String
The Service stated in the principal expression of the policy.
Search for bucket policies with a particular Service user specified in the NotPrincipal section:  [See the AWS documentation website for more details]


policy.Policy.Statement.Resource
Policy.Statement.Resource
get-bucket-policy
String
The S3 resource that the S3 bucket policy is applied to.
Search for S3 bucket policies containing wildcards:  [See the AWS documentation website for more details]


policy.Policy.Statement.Sid
Policy.Statement.Sid
get-bucket-policy
String
The Sid of the S3 bucket policy.
Search for bucket policies with a particular Sid:  [See the AWS documentation website for more details]


policy.Policy.Version
Policy.Version
get-bucket-policy
String
The version number for the S3 bucket policy.
Search for bucket policies with a particular version:  [See the AWS documentation website for more details]


tagging.TagSet.Key
TagSet.Key
get-bucket-tagging
String
The key of the S3 bucket tag.
Search for bucket policies with a particular tag key:  [See the AWS documentation website for more details]


tagging.TagSet.Value
TagSet.Value
get-bucket-tagging
String
The value of the S3 bucket tag.
Search for bucket policies with a particular tag value:  [See the AWS documentation website for more details]


versioning.MFADelete
MFADelete
get-bucket-versioning
String
The MFADelete (enabled/disabled) state of the bucket version configuration.
Search for buckets where MFADelete is enabled in the bucket versioning configuration:  [See the AWS documentation website for more details]


website.ErrorDocument.Key
ErrorDocument.Key
get-bucket-website
String
The error document configured as part of S3 static website hosting.
Search for S3 buckets configured for static website hosting and with an error page redirection to 404.html:  [See the AWS documentation website for more details]


website.IndexDocument.Suffix
IndexDocument.Suffix
get-bucket-website
String
The suffix of a webpage that Amazon S3 returns when a request is made to the root of a website or any subfolder.
Search for the index document configured as part of S3 static website hosting and with an index page redirection to index.html:  [See the AWS documentation website for more details]


[See the AWS documentation website for more details]
[See the AWS documentation website for more details]
get-bucket-lifecycle_configuration
[See the AWS documentation website for more details]
For more information, see GET Bucket lifecycle.
Search for the S3 buckets with a lifecycle configuration rule whose expiration is less than 3 days:  [See the AWS documentation website for more details]



S3 Bucket Properties Data Fields That Macie Generates



Macie Field Name
Macie Field Type
Description
Example search query




@timestamp
Date
The timestamp when Macie last analyzed the bucket.
Search for S3 buckets that Macie analyzed in the last 24 hours:  [See the AWS documentation website for more details]


accountId
String
The account ID of the S3 bucket owner.
Search for any S3 buckets that don't belong to a given account:  [See the AWS documentation website for more details]


bucket
String
The name of an S3 bucket.
Search for a particular S3 bucket by name:  [See the AWS documentation website for more details]


s3_world_readability
String
A value indicating whether the S3 bucket is globally readable: true, false, or unknown. The unknown value indicates that Macie can't determine whether the S3 bucket is globally readable.
Search for S3 buckets that are globally readable by either the Amazon S3 ACL or bucket (IAM) policy:  [See the AWS documentation website for more details]


s3_world_writability
String
A value indicating if the S3 bucket is globally writable: true, false, or unknown. The unknown value indicates that Macie can't determine whether the S3 bucket is globally writable.
Search for S3 buckets that is globally writable by either the Amazon S3 ACL or the bucket (IAM) policy:  [See the AWS documentation website for more details]


