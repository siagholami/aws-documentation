Agent Installation on Windows
Complete the following procedure to install an agent on Windows. Be sure that your Migration Hub home region has been set before you begin this procedure.
To install AWS Application Discovery Agent in your data center


Navigate to the Microsoft Download Center and choose Download to be taken to the download selection page, then on this page, select only vc_redist.x86.exe (do not select the "x64" version) regardless of the architecture of the machine you are installing on, then choose Next. Your download begins immediately.


Download the Windows agent installer but do not double-click to run the installer within Windows.
Important
Do not double-click to run the installer within Windows as it will fail to install. Agent installation only works from the command prompt. (If you already double-clicked on the installer, you must go to Add/Remove Programs and uninstall the agent before continuing on with the remaining installation steps.)


Open a command prompt as an administrator and navigate to the location where you saved the installation package.


To install the agent, choose one of the following installation methods.  
[See the AWS documentation website for more details]


If outbound connections from your network are restricted, you'll need to update your firewall settings. Agents require access to arsenal over TCP port 443. They don't require any inbound ports to be open.
    For example, if your home region is eu-central-1, you'd use https://arsenal-discovery.eu-central-1.amazonaws.com:443
    Or substitute your home region as needed for all other regions except us-west-2.
    If us-west-2 is your home region, use https://arsenal.us-west-2.amazonaws.com:443


Package Signing on Windows 2003
For Windows Server 2008 and later, Amazon cryptographically signs the Application Discovery Service agent installation package with an SHA256 certificate. However, because the SHA2 certificate family is not supported by Windows Server 2003, the installation package for that platform is signed with an SHA1 certificate. Microsoft has published hotfixes that might allow your Windows 2003 systems to read an SHA256 certificate. If you require SHA256 in your Windows 2003 environment, contact AWS Support for assistance. 
Manage the Discovery Agent Process on Windows
You can manage the behavior of the Discovery Agent at the system level through the Windows Server Manager Services console. The following table describes how.



Task
Service Name
Service Status/Action




Verify that an agent is running
AWS Discovery Agent AWS Discovery Updater
Started


Start an agent
AWS Discovery Agent AWS Discovery Updater
Choose Start


Stop an agent
AWS Discovery Agent AWS Discovery Updater
Choose Stop


Restart an agent
AWS Discovery Agent AWS Discovery Updater
Choose Restart



To uninstall a discovery agent on Windows


Open Control Panel in Windows.


Choose Programs.


Choose Programs and Features.


Select AWS Discovery Agent.


Choose Uninstall.


Agent Troubleshooting on Windows
If you encounter problems while installing or using the Application Discovery Agent on Windows, consult the following guidance about logging and configuration. When helping to troubleshoot potential issues with the agent or its connection to the Application Discovery Service, AWS Support often requests these files. 
 Installation logging 
In some cases, the msiexec command described preceding appears to fail. For example, a failure can appear with the Windows Services Manager showing that the discovery services are not being created. In this case, add /L*V install.log to the command to generate a verbose installation log.
  Operational logging 
On Windows Server 2008 and later, agent log files can be found under the following directory.
C:\ProgramData\AWS\AWS Discovery\Logs
On Windows Server 2003, agent log files can be found under the following directory.
C:\Documents and Settings\All Users\Application Data\AWS\AWSDiscovery\Logs
Logs files are named to indicate whether generated by the main service, automatic upgrader, or installer.
 Configuration file
On Windows Server 2008 and later, the agent configuration file can be found at the following location.
C:\ProgramData\AWS\AWS Discovery\config
On Windows Server 2003, the agent configuration file can be found at the following location.
C:\Documents and Settings\All Users\Application Data\AWS\AWS Discovery\config
 For instructions on how to remove older versions of the Discovery Agent, see Prerequisites for Agent Installation.