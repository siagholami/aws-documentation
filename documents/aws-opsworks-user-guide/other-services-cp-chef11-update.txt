Step 6 (Optional): Update the app code to see CodePipeline redeploy your app automatically
When you make changes to code in apps or cookbooks that you have deployed by using CodePipeline, the updated artifacts will be deployed automatically by CodePipeline to your target instances (in this case, to a target AWS OpsWorks Stacks stack). This section shows you the automatic redeployment when you update the code in your sample PHP app.
To edit the code in the sample app


Sign in to the AWS Management Console and open the Amazon S3 console at https://console.aws.amazon.com/s3/.


Open the bucket in which you are storing your sample PHP app.



Select the ZIP file that contains the app. On the Actions menu, choose Download.


In the dialog box, open the context (right-click) menu, choose Download, and then save the ZIP file to a convenient location. Choose OK.


Extract the contents of the ZIP file to a convenient location. You might need to change permissions on the extracted folder and its subfolders and contents to allow editing. In the opsworks-demo-php-simple-app-version1 folder, open the index.php file for editing.


Search for the phrase, Your PHP application is now running. Replace the text, Your PHP application is now running with You've just deployed your first app to AWS OpsWorks with AWS CodePipeline,. Do not edit the variables.



Save and close the index.php file.


Zip the opsworks-demo-php-simple-app-version1 folder, and save the ZIP file to a convenient location. Do not change the name of the ZIP file.


Upload the new ZIP file to your Amazon S3 bucket. In this walkthrough, the name of the bucket is my-appbucket.


Open the CodePipeline console, and open your AWS OpsWorks Stacks pipeline (MyOpsWorksPipeline). Choose Release Change.


(You can wait for CodePipeline to detect the code change from the updated version of the app in your Amazon S3 bucket. To save you time, this walkthrough instructs you to simply choose Release Change.)

Observe as CodePipeline runs through the stages of the pipeline. First, CodePipeline detects changes to the source artifact.


CodePipeline pushes the updated code to your stack in AWS OpsWorks Stacks.



When both stages of the pipeline have been successfully completed, open your stack in AWS OpsWorks Stacks (MyStack).


On the MyStack properties page, choose Instances.


In the Public IP column, choose the public IP address of your instance to view the updated app's text.


