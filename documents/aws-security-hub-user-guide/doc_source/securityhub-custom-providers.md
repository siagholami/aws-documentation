# Using custom product integrations to send findings to AWS Security Hub<a name="securityhub-custom-providers"></a>

In addition to findings generated by the integrated AWS services and third\-party products, Security Hub can also consume findings that are generated by other custom security products you may use\.

You can send these findings into Security Hub manually using the [https://docs.aws.amazon.com/securityhub/1.0/APIReference/API_BatchImportFindings.html](https://docs.aws.amazon.com/securityhub/1.0/APIReference/API_BatchImportFindings.html) API operation\.

## Requirements and recommendations for sending findings from custom security products<a name="securityhub-custom-providers-bfi-reqs"></a>

Before you can successfully invoke the [https://docs.aws.amazon.com/securityhub/1.0/APIReference/API_BatchImportFindings.html](https://docs.aws.amazon.com/securityhub/1.0/APIReference/API_BatchImportFindings.html) API operation, you must enable Security Hub\.

You must provide the finding details using the [AWS Security Finding Format \(ASFF\)](securityhub-findings-format.md)\. For the findings from your custom integration, use the following requirements and recommendations\.

**Setting the product ARN**  
When you enable Security Hub, a default product Amazon Resource Name \(ARN\) for Security Hub is generated in your current account\.  
This product ARN has the following format: `arn:aws:securityhub:<region>:<account-id>:product/<account-id>/default`\. For example, `arn:aws:securityhub:us-west-2:123456789012:product/123456789012/default`\.  
Use this product ARN as the value for the [https://docs.aws.amazon.com/securityhub/1.0/APIReference/API_AwsSecurityFinding.html#securityhub-Type-AwsSecurityFinding-ProductArn](https://docs.aws.amazon.com/securityhub/1.0/APIReference/API_AwsSecurityFinding.html#securityhub-Type-AwsSecurityFinding-ProductArn) attribute when invoking the `BatchImportFindings` API operation\.

**Defining the product name**  
We recommend that you use the [https://docs.aws.amazon.com/securityhub/1.0/APIReference/API_AwsSecurityFinding.html#securityhub-Type-AwsSecurityFinding-ProductFields](https://docs.aws.amazon.com/securityhub/1.0/APIReference/API_AwsSecurityFinding.html#securityhub-Type-AwsSecurityFinding-ProductFields) attribute to define the name of the product that generates the findings that you are sending to Security Hub\.  
For example\.  

```
"ProductFields": 
  {
    "ProviderName": "<name of the product>",
    "ProviderVersion": "<product version>",
  }
```

**Setting the finding IDs**  
You must supply, manage, and increment your own finding IDs, using the [https://docs.aws.amazon.com/securityhub/1.0/APIReference/API_AwsSecurityFinding.html#securityhub-Type-AwsSecurityFinding-Id](https://docs.aws.amazon.com/securityhub/1.0/APIReference/API_AwsSecurityFinding.html#securityhub-Type-AwsSecurityFinding-Id) attribute\.  
Each new finding must have a unique finding ID\.

**Setting the account ID**  
You must specify your own account ID, using the [https://docs.aws.amazon.com/securityhub/1.0/APIReference/API_AwsSecurityFinding.html#securityhub-Type-AwsSecurityFinding-AwsAccountId](https://docs.aws.amazon.com/securityhub/1.0/APIReference/API_AwsSecurityFinding.html#securityhub-Type-AwsSecurityFinding-AwsAccountId) attribute\.

**Setting the created at and updated at dates**  
You must supply your own timestamps for the [https://docs.aws.amazon.com/securityhub/1.0/APIReference/API_AwsSecurityFinding.html#securityhub-Type-AwsSecurityFinding-CreatedAt](https://docs.aws.amazon.com/securityhub/1.0/APIReference/API_AwsSecurityFinding.html#securityhub-Type-AwsSecurityFinding-CreatedAt) and [https://docs.aws.amazon.com/securityhub/1.0/APIReference/API_AwsSecurityFinding.html#securityhub-Type-AwsSecurityFinding-UpdatedAt](https://docs.aws.amazon.com/securityhub/1.0/APIReference/API_AwsSecurityFinding.html#securityhub-Type-AwsSecurityFinding-UpdatedAt) attributes\.

## Updating findings from custom products<a name="securityhub-custom-providers-update-findings"></a>

In addition to sending new findings from custom products, you can also use the [https://docs.aws.amazon.com/securityhub/1.0/APIReference/API_BatchImportFindings.html](https://docs.aws.amazon.com/securityhub/1.0/APIReference/API_BatchImportFindings.html) API operation to update existing findings from custom products\.

To update existing findings, use the existing finding ID \(via the [https://docs.aws.amazon.com/securityhub/1.0/APIReference/API_AwsSecurityFinding.html#securityhub-Type-AwsSecurityFinding-Id](https://docs.aws.amazon.com/securityhub/1.0/APIReference/API_AwsSecurityFinding.html#securityhub-Type-AwsSecurityFinding-Id) attribute\)\. Resend the full finding with the appropriate information updated in the request, including a modified [https://docs.aws.amazon.com/securityhub/1.0/APIReference/API_AwsSecurityFinding.html#securityhub-Type-AwsSecurityFinding-UpdatedAt](https://docs.aws.amazon.com/securityhub/1.0/APIReference/API_AwsSecurityFinding.html#securityhub-Type-AwsSecurityFinding-UpdatedAt) timestamp\.

## Example custom integrations<a name="securityhub-custom-providers-examples"></a>

You can use the following example custom product integrations as a guide to create your own custom solution\.

AWS Fargate and Prowler  
[Prowler](https://github.com/toniblyx/prowler) provides dozens of security configuration checks related to services such as Amazon Redshift, Amazon ElastiCache, Amazon API Gateway, and Amazon CloudFront\.  
To learn more, see [Use AWS Fargate and Prowler to send security configuration findings about AWS services to Security Hub](http://aws.amazon.com/blogs/security/use-aws-fargate-prowler-send-security-configuration-findings-about-aws-services-security-hub/)\.

Importing AWS Config rules  
You can use an AWS CloudFormation template to import AWS Config rules into Security Hub\.  
To learn more, see [How to import AWS Config rules evaluations as findings in Security Hub](http://aws.amazon.com/blogs/security/how-to-import-aws-config-rules-evaluations-findings-security-hub/)\.