Working with VTL Devices
Your tape gateway setup provides the following SCSI devices, which you select when activating your gateway.
Topics
 Selecting a Medium Changer After Gateway Activation
 Updating the Device Driver for Your Medium Changer
 Displaying Barcodes for Tapes in Microsoft System Center DPM
For medium changers, AWS Storage Gateway works with the following: 
 AWS-Gateway-VTL – This device is provided with the gateway.
 STK-L700 – This device emulation is provided with the gateway.
When activating your tape gateway, you select your backup application from the list and storage gateway uses the appropriate medium changer. If your backup application is not listed, you choose Other and then choose the medium changer that works with backup application.
The type of medium changer you choose depends on the backup application you plan to use. The following table lists third-party backup applications that have been tested and found to be compatible with tape gateways. This table includes the medium changer type recommended for each backup application.  
[See the AWS documentation website for more details]
Important
We highly recommend that you choose the medium changer that's listed for your backup application. Other medium changers might not function properly. You can choose a different medium changer after the gateway is activated. For more information, see Selecting a Medium Changer After Gateway Activation.
For tape drives, Storage Gateway works with the following:
 IBM-ULT3580-TD5—This device emulation is provided with the gateway.
Selecting a Medium Changer After Gateway Activation
After your gateway is activated, you can choose to select a different medium changer type. 
Important
If your tape gateway uses the Symantec Backup Exec 2014 or NetBackup 7.x backup software, you must select the AWS-Gateway-VTL device type. For more information on how to change the medium changer after gateway activation for these applications, see Best Practices for using Veritas Backup products (NetBackup, Backup Exec) with the Amazon Web Services (AWS) Storage Tape Gateway-VTL in Symantec Support.
To select a different medium changer type after gateway activation


Stop any related jobs that are running in your backup software.


On the Windows server, open the iSCSI initiator properties window.


Choose the Targets tab to display the discovered targets.


On the Discovered targets pane, choose the medium changer you want to change, choose Disconnect, and then choose OK. 


On the Storage Gateway console, choose Gateways from the navigation pane, and then choose the gateway whose medium changer you want to change.


Choose the VTL Devices tab, select the medium changer you want to change, and then choose Change Media Changer.



In the Change Media Changer Type dialog box that appears, select the media changer you want from the drop-down list box and then choose Save.


Updating the Device Driver for Your Medium Changer
Depending on the backup software you use on your Windows server, you might need to update the driver for your medium changer. 


Open Device Manager on your Windows server, and expand the Medium Changer devices tree.


Open the context (right-click) menu for Unknown Medium Changer, and choose Update Driver Software to open the Update Driver Software-unknown Medium Changer window.





In the How do you want to search for driver software? section, choose Browse my computer for driver software.


Choose Let me pick from a list of device drivers on my computer. 
Note
We recommend using the Sony TSL-A500C Autoloader driver with the Veeam Backup & Replication V7, Veeam Backup & Replication V8, and Microsoft System Center Data Protection Manager backup software. This Sony driver has been tested with these types of backup software.


In the Select the device driver you want to install for this hardware section, clear the Show compatible hardware check box, choose Sony in the Manufacturer list, choose Sony - TSL-A500C Autoloader in the Model list, and then choose Next.



In the warning box that appears, choose Yes. If the driver is successfully installed, close the Update drive software window.


Displaying Barcodes for Tapes in Microsoft System Center DPM
If you use the media changer driver for Sony TSL-A500C Autoloader, Microsoft System Center Data Protection Manager doesn't automatically display barcodes for virtual tapes created in Storage Gateway. To display barcodes correctly for your tapes, change the media changer driver to Sun/StorageTek Library.
To display barcodes


Ensure that all backup jobs have completed and that there are no tasks pending or in progress.


Eject and move the tapes to offline storage (GLACIER or DEEP_ARCHIVE) and exit the DPM Administrator console. For information about how to eject a tape in DPM, see Archiving a Tape by Using DPM.


In Administrative Tools, choose Services and open the context (right-click) menu for DPM Service in the Detail pane, and then choose Properties.


On the General tab, ensure that the Startup type is set to Automatic and choose Stop to stop the DPM service.


Get the StorageTek drivers from Microsoft Update Catalog on the Microsoft website. 
Note
Take note of the different drivers for the different sizes.


For Size 18K, choose x86 drivers.
For Size 19K, choose x64 drivers.


On your Windows server, open Device Manager, and expand the Medium Changer Devices tree.


Open the context (right-click) menu for Unknown Medium Changer, and choose Update Driver Software to open the Update Driver Software-unknown Medium Changer window.


Browse to the path of the new driver location and install. The driver appears as Sun/StorageTek Library. The tape drives remain as an IBM ULT3580-TD5 SCSI sequential device. 


Reboot the DPM server.


In the Storage Gateway console, create new tapes.


Open the DPM Administrator console, choose Management, then choose Rescan for new tape libraries . You should see the Sun/StorageTek library.


Choose the library and choose Inventory.


Choose Add Tapes to add the new tapes into DPM. The new tapes should now display their barcodes.

